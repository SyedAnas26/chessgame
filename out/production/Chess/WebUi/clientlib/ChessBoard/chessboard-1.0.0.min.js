!function(){"use strict";var e=window.jQuery,r="abcdefgh".split(""),n=20,t="â€¦",o="1.8.3",a="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",i=E(a),s=200,p=200,c=60,u=30,f=100,d={};function l(e,r,n){var t=0,o=!1,a=[],i=function(){t=0,o&&(o=!1,s())},s=function(){t=window.setTimeout(i,r),e.apply(n,a)};return function(e){a=arguments,t?o=!0:s()}}function h(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(e){return(16*Math.random()|0).toString(16)})}function v(e){return JSON.parse(JSON.stringify(e))}function g(e){var r=e.split(".");return{major:parseInt(r[0],10),minor:parseInt(r[1],10),patch:parseInt(r[2],10)}}function w(e,r){for(var n in r)if(r.hasOwnProperty(n))for(var t="{"+n+"}",o=r[n];-1!==e.indexOf(t);)e=e.replace(t,o);return e}function b(e){return"string"==typeof e}function m(e){return"function"==typeof e}function P(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function y(e){return"fast"===e||"slow"===e||!!P(e)&&e>=0}function x(e){if(!b(e))return!1;var r=e.split("-");return 2===r.length&&(O(r[0])&&O(r[1]))}function O(e){return b(e)&&-1!==e.search(/^[a-h][1-8]$/)}function S(e){return b(e)&&-1!==e.search(/^[bw][KQRNBP]$/)}function T(e){if(!b(e))return!1;var r=(e=function(e){return e.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")}(e=e.replace(/ .+$/,""))).split("/");if(8!==r.length)return!1;for(var n=0;n<8;n++)if(8!==r[n].length||-1!==r[n].search(/[^kqrnbpKQRNBP1]/))return!1;return!0}function q(r){if(!e.isPlainObject(r))return!1;for(var n in r)if(r.hasOwnProperty(n)&&(!O(n)||!S(r[n])))return!1;return!0}function k(){return typeof window.$&&e.fn&&e.fn.jquery&&(r=e.fn.jquery,n=o,r=g(r),n=g(n),1e5*r.major*1e5+1e5*r.minor+r.patch>=1e5*n.major*1e5+1e5*n.minor+n.patch);var r,n}function E(e){if(!T(e))return!1;for(var n,t=(e=e.replace(/ .+$/,"")).split("/"),o={},a=8,i=0;i<8;i++){for(var s=t[i].split(""),p=0,c=0;c<s.length;c++){if(-1!==s[c].search(/[1-8]/))p+=parseInt(s[c],10);else o[r[p]+a]=(n=s[c]).toLowerCase()===n?"b"+n.toUpperCase():"w"+n.toUpperCase(),p+=1}a-=1}return o}function C(e){if(!q(e))return!1;for(var n,t,o="",a=8,i=0;i<8;i++){for(var s=0;s<8;s++){var p=r[s]+a;e.hasOwnProperty(p)?o+=(n=e[p],t=void 0,"w"===(t=n.split(""))[0]?t[1].toUpperCase():t[1].toLowerCase()):o+="1"}7!==i&&(o+="/"),a-=1}return o=function(e){return e.replace(/11111111/g,"8").replace(/1111111/g,"7").replace(/111111/g,"6").replace(/11111/g,"5").replace(/1111/g,"4").replace(/111/g,"3").replace(/11/g,"2")}(o)}function B(e,n,t){for(var o=function(e){for(var n=[],t=0;t<8;t++)for(var o=0;o<8;o++){var a=r[t]+(o+1);e!==a&&n.push({square:a,distance:(i=e,s=a,p=void 0,c=void 0,u=void 0,f=void 0,d=void 0,l=void 0,h=void 0,v=void 0,p=i.split(""),c=r.indexOf(p[0])+1,u=parseInt(p[1],10),f=s.split(""),d=r.indexOf(f[0])+1,l=parseInt(f[1],10),h=Math.abs(c-d),v=Math.abs(u-l),h>=v?h:v)})}var i,s,p,c,u,f,d,l,h,v;n.sort(function(e,r){return e.distance-r.distance});var g=[];for(t=0;t<n.length;t++)g.push(n[t].square);return g}(t),a=0;a<o.length;a++){var i=o[a];if(e.hasOwnProperty(i)&&e[i]===n)return i}return!1}function I(e){var r;return"black"!==e.orientation&&(e.orientation="white"),!1!==e.showNotation&&(e.showNotation=!0),!0!==e.draggable&&(e.draggable=!1),"trash"!==e.dropOffBoard&&(e.dropOffBoard="snapback"),!0!==e.sparePieces&&(e.sparePieces=!1),e.sparePieces&&(e.draggable=!0),e.hasOwnProperty("pieceTheme")&&(b(e.pieceTheme)||m(e.pieceTheme))||(e.pieceTheme="img/{piece}.png"),y(e.appearSpeed)||(e.appearSpeed=s),y(e.moveSpeed)||(e.moveSpeed=p),y(e.snapbackSpeed)||(e.snapbackSpeed=c),y(e.snapSpeed)||(e.snapSpeed=u),y(e.trashSpeed)||(e.trashSpeed=f),P(r=e.dragThrottleRate)&&r>=1||(e.dragThrottleRate=n),e}d.alpha="alpha-d2270",d.black="black-3c85d",d.board="board-b72b1",d.chessboard="chessboard-63f37",d.clearfix="clearfix-7da63",d.highlight1="highlight1-32417",d.highlight2="highlight2-9c5d2",d.notation="notation-322f9",d.numeric="numeric-fc462",d.piece="piece-417db",d.row="row-5277c",d.sparePieces="spare-pieces-7492f",d.sparePiecesBottom="spare-pieces-bottom-ae20f",d.sparePiecesTop="spare-pieces-top-4028b",d.square="square-55d63",d.white="white-1e1d7",window.Chessboard=function(n,a){if(!function(){if(!k()){var e="Chessboard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+o+" or higher on the page\n\nExiting"+t;return window.alert(e),!1}return!0}())return null;var s=function(r){if(""===r){var n="Chessboard Error 1001: The first argument to Chessboard() cannot be an empty string.\n\nExiting"+t;return window.alert(n),!1}b(r)&&"#"!==r.charAt(0)&&(r="#"+r);var o=e(r);if(1!==o.length){var a="Chessboard Error 1003: The first argument to Chessboard() must be the ID of a DOM node, an ID query selector, or a single DOM node.\n\nExiting"+t;return window.alert(a),!1}return o}(n);if(!s)return null;a=I(a=function(r){return"start"===r?r={position:v(i)}:T(r)?r={position:E(r)}:q(r)&&(r={position:v(r)}),e.isPlainObject(r)||(r={}),r}(a));var p=null,c=null,u=null,f=null,g={},P=2,y="white",S={},M=null,N=null,j=null,D=!1,R={},Q={},X={},Y=16,K=!1;function L(e,r,n){if(!0===a.hasOwnProperty("showErrors")&&!1!==a.showErrors){var t="Chessboard Error "+e+": "+r;return"console"===a.showErrors&&"object"==typeof console&&"function"==typeof console.log?(console.log(t),void(arguments.length>=2&&console.log(n))):"alert"===a.showErrors?(n&&(t+="\n\n"+JSON.stringify(n)),void window.alert(t)):void(m(a.showErrors)&&a.showErrors(e,r,n))}}function U(e){return m(a.pieceTheme)?a.pieceTheme(e):b(a.pieceTheme)?w(a.pieceTheme,{piece:e}):(L(8272,"Unable to build image source for config.pieceTheme."),"")}function $(e,r,n){var t='<img src="'+U(e)+'" ';return b(n)&&""!==n&&(t+='id="'+n+'" '),t+='alt="" class="{piece}" data-piece="'+e+'" style="width:'+Y+"px;height:"+Y+"px;",r&&(t+="display:none;"),w(t+='" />',d)}function J(e){var r=["wK","wQ","wR","wB","wN","wP"];"black"===e&&(r=["bK","bQ","bR","bB","bN","bP"]);for(var n="",t=0;t<r.length;t++)n+=$(r[t],!1,R[r[t]]);return n}function z(r,n,t,o){var i=e("#"+Q[r]),s=i.offset(),p=e("#"+Q[n]),c=p.offset(),u=h();e("body").append($(t,!0,u));var f=e("#"+u);f.css({display:"",position:"absolute",top:s.top,left:s.left}),i.find("."+d.piece).remove();var l={duration:a.moveSpeed,complete:function(){p.append($(t)),f.remove(),m(o)&&o()}};f.animate(c,l)}function F(r,n,t){var o=e("#"+R[r]).offset(),i=e("#"+Q[n]),s=i.offset(),p=h();e("body").append($(r,!0,p));var c=e("#"+p);c.css({display:"",position:"absolute",left:o.left,top:o.top});var u={duration:a.moveSpeed,complete:function(){i.find("."+d.piece).remove(),i.append($(r)),c.remove(),m(t)&&t()}};c.animate(s,u)}function A(){for(var r in p.find("."+d.piece).remove(),S)S.hasOwnProperty(r)&&e("#"+Q[r]).append($(S[r]))}function W(){p.html(function(e){"black"!==e&&(e="white");var n="",t=v(r),o=8;"black"===e&&(t.reverse(),o=1);for(var i="white",s=0;s<8;s++){n+='<div class="{row}">';for(var p=0;p<8;p++){var c=t[p]+o;n+='<div class="{square} '+d[i]+" square-"+c+'" style="width:'+Y+"px;height:"+Y+'px;" id="'+Q[c]+'" data-square="'+c+'">',a.showNotation&&(("white"===e&&1===o||"black"===e&&8===o)&&(n+='<div class="{notation} {alpha}">'+t[p]+"</div>"),0===p&&(n+='<div class="{notation} {numeric}">'+o+"</div>")),n+="</div>",i="white"===i?"black":"white"}n+='<div class="{clearfix}"></div></div>',i="white"===i?"black":"white","white"===e?o-=1:o+=1}return w(n,d)}(y,a.showNotation)),A(),a.sparePieces&&("white"===y?(u.html(J("black")),f.html(J("white"))):(u.html(J("white")),f.html(J("black"))))}function G(e){var r=v(S),n=v(e);C(r)!==C(n)&&(m(a.onChange)&&a.onChange(r,n),S=e)}function H(e,r){for(var n in X)if(X.hasOwnProperty(n)){var t=X[n];if(e>=t.left&&e<t.left+Y&&r>=t.top&&r<t.top+Y)return n}return"offboard"}function V(){p.find("."+d.square).removeClass(d.highlight1+" "+d.highlight2)}function Z(){V();var e=v(S);delete e[j],G(e),A(),c.fadeOut(a.trashSpeed),D=!1}function _(r,n,t,o){m(a.onDragStart)&&!1===a.onDragStart(r,n,v(S),y)||(D=!0,M=n,j=r,N="spare"===r?"offboard":r,function(){for(var r in X={},Q)Q.hasOwnProperty(r)&&(X[r]=e("#"+Q[r]).offset())}(),c.attr("src",U(n)).css({display:"",position:"absolute",left:t-Y/2,top:o-Y/2}),"spare"!==r&&e("#"+Q[r]).addClass(d.highlight1).find("."+d.piece).css("display","none"))}function ee(r,n){c.css({left:r-Y/2,top:n-Y/2});var t=H(r,n);t!==N&&(O(N)&&e("#"+Q[N]).removeClass(d.highlight2),O(t)&&e("#"+Q[t]).addClass(d.highlight2),m(a.onDragMove)&&a.onDragMove(t,N,j,M,v(S),y),N=t)}function re(r){var n="drop";if("offboard"===r&&"snapback"===a.dropOffBoard)n="snapback",K=!1;else{if(0==K)return void(K=!0);K=!1}if("offboard"===r&&"trash"===a.dropOffBoard&&(n="trash"),m(a.onDrop)){var t=v(S);"spare"===j&&O(r)&&(t[r]=M),O(j)&&"offboard"===r&&delete t[j],O(j)&&O(r)&&(delete t[j],t[r]=M);var o=v(S),i=a.onDrop(j,r,M,t,o,y);"snapback"!==i&&"trash"!==i||(n=i)}"snapback"===n?function(){if("spare"!==j){V();var r=e("#"+Q[j]).offset(),n={duration:a.snapbackSpeed,complete:function(){A(),c.css("display","none"),m(a.onSnapbackEnd)&&a.onSnapbackEnd(M,j,v(S),y)}};c.animate(r,n),D=!1}else Z()}():"trash"===n?Z():"drop"===n&&function(r){if(0!=K||r!==j){K=!1,V();var n=v(S);delete n[j],n[r]=M,G(n);var t=e("#"+Q[r]).offset(),o={duration:a.snapSpeed,complete:function(){A(),c.css("display","none"),m(a.onSnapEnd)&&a.onSnapEnd(j,r,M)}};c.animate(t,o),D=!1}else K=!0}(r)}function ne(e){e.preventDefault()}function te(r){if(a.draggable){var n=e(this).attr("data-square");O(n)&&S.hasOwnProperty(n)&&_(n,S[n],r.pageX,r.pageY)}}function oe(r){if(a.draggable){var n=e(this).attr("data-square");O(n)&&S.hasOwnProperty(n)&&(r=r.originalEvent,_(n,S[n],r.changedTouches[0].pageX,r.changedTouches[0].pageY))}}function ae(r){a.sparePieces&&_("spare",e(this).attr("data-piece"),r.pageX,r.pageY)}function ie(r){a.sparePieces&&_("spare",e(this).attr("data-piece"),(r=r.originalEvent).changedTouches[0].pageX,r.changedTouches[0].pageY)}g.clear=function(e){g.position({},e)},g.destroy=function(){s.html(""),c.remove(),s.unbind()},g.fen=function(){return g.position("fen")},g.flip=function(){return g.orientation("flip")},g.move=function(){if(0!==arguments.length){for(var e=!0,r={},n=0;n<arguments.length;n++)if(!1!==arguments[n])if(x(arguments[n])){var t=arguments[n].split("-");r[t[0]]=t[1]}else L(2826,"Invalid move passed to the move method.",arguments[n]);else e=!1;var o=function(e,r){var n=v(e);for(var t in r)if(r.hasOwnProperty(t)&&n.hasOwnProperty(t)){var o=n[t];delete n[t],n[r[t]]=o}return n}(S,r);return g.position(o,e),o}},g.orientation=function(e){return 0===arguments.length?y:"white"===e||"black"===e?(y=e,W(),y):"flip"===e?(y="white"===y?"black":"white",W(),y):void L(5482,"Invalid value passed to the orientation method.",e)},g.position=function(r,n){return 0===arguments.length?v(S):b(r)&&"fen"===r.toLowerCase()?C(S):(b(r)&&"start"===r.toLowerCase()&&(r=v(i)),T(r)&&(r=E(r)),void(q(r)?(!1!==n&&(n=!0),n?(function(r,n,t){if(0!==r.length)for(var o=0,i=0;i<r.length;i++){var s=r[i];"clear"===s.type?e("#"+Q[s.square]+" ."+d.piece).fadeOut(a.trashSpeed,p):"add"!==s.type||a.sparePieces?"add"===s.type&&a.sparePieces?F(s.piece,s.square,p):"move"===s.type&&z(s.source,s.destination,s.piece,p):e("#"+Q[s.square]).append($(s.piece,!0)).find("."+d.piece).fadeIn(a.appearSpeed,p)}function p(){(o+=1)===r.length&&(A(),m(a.onMoveEnd)&&a.onMoveEnd(v(n),v(t)))}}(function(e,r){e=v(e),r=v(r);var n=[],t={};for(var o in r)r.hasOwnProperty(o)&&e.hasOwnProperty(o)&&e[o]===r[o]&&(delete e[o],delete r[o]);for(o in r)if(r.hasOwnProperty(o)){var a=B(e,r[o],o);a&&(n.push({type:"move",source:a,destination:o,piece:r[o]}),delete e[a],delete r[o],t[o]=!0)}for(o in r)r.hasOwnProperty(o)&&(n.push({type:"add",square:o,piece:r[o]}),delete r[o]);for(o in e)e.hasOwnProperty(o)&&(t.hasOwnProperty(o)||(n.push({type:"clear",square:o,piece:e[o]}),delete e[o]));return n}(S,r),S,r),G(r)):(G(r),A())):L(6482,"Invalid value passed to the position method.",r)))},g.resize=function(){Y=function(){var e=parseInt(s.width(),10);if(!e||e<=0)return 0;for(var r=e-1;r%8!=0&&r>0;)r-=1;return r/8}(),p.css("width",8*Y+"px"),c.css({height:Y,width:Y}),a.sparePieces&&s.find("."+d.sparePieces).css("paddingLeft",Y+P+"px"),W()},g.start=function(e){g.position("start",e)};var se=l(function(e){D&&ee(e.pageX,e.pageY)},a.dragThrottleRate),pe=l(function(e){D&&(e.preventDefault(),ee(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))},a.dragThrottleRate);function ce(e){D&&re(H(e.pageX,e.pageY))}function ue(e){D&&re(H(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))}function fe(r){if(!D&&m(a.onMouseoverSquare)){var n=e(r.currentTarget).attr("data-square");if(O(n)){var t=!1;S.hasOwnProperty(n)&&(t=S[n]),a.onMouseoverSquare(n,t,v(S),y)}}}function de(r){if(!D&&m(a.onMouseoutSquare)){var n=e(r.currentTarget).attr("data-square");if(O(n)){var t=!1;S.hasOwnProperty(n)&&(t=S[n]),a.onMouseoutSquare(n,t,v(S),y)}}}return y=a.orientation,a.hasOwnProperty("position")&&("start"===a.position?S=v(i):T(a.position)?S=E(a.position):q(a.position)?S=v(a.position):L(7263,"Invalid value passed to config.position.",a.position)),function(){var n,t;!function(){for(var e=0;e<r.length;e++)for(var n=1;n<=8;n++){var t=r[e]+n;Q[t]=t+"-"+h()}var o="KQRNBP".split("");for(e=0;e<o.length;e++){var a="w"+o[e],i="b"+o[e];R[a]=a+"-"+h(),R[i]=i+"-"+h()}}(),s.html((n=a.sparePieces,t='<div class="{chessboard}">',n&&(t+='<div class="{sparePieces} {sparePiecesTop}"></div>'),t+='<div class="{board}"></div>',n&&(t+='<div class="{sparePieces} {sparePiecesBottom}"></div>'),w(t+="</div>",d))),p=s.find("."+d.board),a.sparePieces&&(u=s.find("."+d.sparePiecesTop),f=s.find("."+d.sparePiecesBottom));var o=h();e("body").append($("wP",!0,o)),c=e("#"+o),P=parseInt(p.css("borderLeftWidth"),10),g.resize()}(),function(){e("body").on("mousedown mousemove","."+d.piece,ne),p.on("mousedown","."+d.square,te),s.on("mousedown","."+d.sparePieces+" ."+d.piece,ae),p.on("mouseenter","."+d.square,fe).on("mouseleave","."+d.square,de);var r=e(window);r.on("mousemove",se).on("mouseup",ce),"ontouchstart"in document.documentElement&&(p.on("touchstart","."+d.square,oe),s.on("touchstart","."+d.sparePieces+" ."+d.piece,ie),r.on("touchmove",pe).on("touchend",ue))}(),g},window.ChessBoard=window.Chessboard,window.Chessboard.fenToObj=E,window.Chessboard.objToFen=C}();