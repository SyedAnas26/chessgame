<!DOCTYPE unspecified PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <script type="text/javascript" src="../clientlib/jquery.min-3.5.js"></script>
    <script type="text/javascript" src="../clientlib/jquery-ui.min.js"></script>
    <script type="text/javascript">
        var userId = '';
        var gamesHistory=[];
        var uniqueId;
        window.onload = function () {
            var x = window.location.origin;
            $.ajax({
                url: x + "/getUserId",
                type: 'POST',
                success: function (response) {
                    userId = response.user_id;
                    uniqueId=response.unique_id;
                    if (userId === 'null') {
                        alert(' Login First ! ');
                        location = '/loginpage';
                    }
                }
            });
        }
    </script>
</head>
<body>
<script type="text/javascript">
    var x=window.location.origin;
    $.ajax({
        url: x + "/getHistory",
        type: 'POST',
        dataType:'text',
        success: function (games) {
            console.log("histry ajax success");
            var gamesArr=games.split(/[\[\],]+/)
            for(var i=1;i<gamesArr.length-1;i++){
                gamesHistory[i]=gamesArr[i];
                if(i%2!=0){
                    createButton(gamesArr[i],gamesArr[i+1]);
                }
            }
        }
    });

    function createButton(game,id) {

        var btn = document.createElement("BUTTON");
        btn.innerHTML = ""+game;
        btn.onclick=function(){
            id=id.split(" ")[1];
            window.location.href ="/PlayPgn?id="+uniqueId+"&gamelog="+id;
        }
        document.body.appendChild(btn);
    }

</script>
<h2 align="center">Your History of Games</h2>
<button onclick="ajax()" value="Get History">Get History</button>
<br>
<br>
</body>
</html>